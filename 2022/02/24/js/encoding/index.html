<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"marked42.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="ç¼–ç é—®é¢˜ä¸ºäº†ææ¸…æ¥š Javascript ä¸­å­—ç¬¦ä¸²ä¸ç¼–ç ç›¸å…³çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£å­—ç¬¦ç¼–ç çš„åŸºæœ¬æ¦‚å¿µã€‚æ–‡ç« ä»‹ç»äº†å­—ç¬¦é›†ï¼ˆCharacter Setï¼‰ã€å­—ç¬¦ç¼–ç ï¼ˆCharacter Encodingï¼‰ã€ç ç‚¹ï¼ˆCode Point)ã€ç¼–ç å•å…ƒï¼ˆCode Unitï¼‰ç­‰æ¦‚å¿µï¼Œä»¥åŠ UCS2 å’Œ UTF16 ä¸¤ç§ç¼–ç æ–¹æ¡ˆçš„å†…å®¹ä¸åŒºåˆ«ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascriptä¸­å­—ç¬¦ä¸²ä¸ç¼–ç é—®é¢˜">
<meta property="og:url" content="http://marked42.github.io/2022/02/24/js/encoding/index.html">
<meta property="og:site_name" content="å‰ç«¯å°K">
<meta property="og:description" content="ç¼–ç é—®é¢˜ä¸ºäº†ææ¸…æ¥š Javascript ä¸­å­—ç¬¦ä¸²ä¸ç¼–ç ç›¸å…³çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£å­—ç¬¦ç¼–ç çš„åŸºæœ¬æ¦‚å¿µã€‚æ–‡ç« ä»‹ç»äº†å­—ç¬¦é›†ï¼ˆCharacter Setï¼‰ã€å­—ç¬¦ç¼–ç ï¼ˆCharacter Encodingï¼‰ã€ç ç‚¹ï¼ˆCode Point)ã€ç¼–ç å•å…ƒï¼ˆCode Unitï¼‰ç­‰æ¦‚å¿µï¼Œä»¥åŠ UCS2 å’Œ UTF16 ä¸¤ç§ç¼–ç æ–¹æ¡ˆçš„å†…å®¹ä¸åŒºåˆ«ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-02-24T21:19:04.000Z">
<meta property="article:modified_time" content="2022-03-06T17:38:01.619Z">
<meta property="article:author" content="penghui">
<meta property="article:tag" content="ç¼–ç ">
<meta property="article:tag" content="Unicode">
<meta property="article:tag" content="å­—ç¬¦ä¸²">
<meta property="article:tag" content="æ­£åˆ™è¡¨è¾¾å¼">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://marked42.github.io/2022/02/24/js/encoding/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Javascriptä¸­å­—ç¬¦ä¸²ä¸ç¼–ç é—®é¢˜ | å‰ç«¯å°K</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">å‰ç«¯å°K</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">21</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">3</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">5</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/marked42" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://marked42.github.io/2022/02/24/js/encoding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="penghui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å‰ç«¯å°K">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Javascriptä¸­å­—ç¬¦ä¸²ä¸ç¼–ç é—®é¢˜
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-02-24 21:19:04" itemprop="dateCreated datePublished" datetime="2022-02-24T21:19:04+00:00">2022-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-03-06 17:38:01" itemprop="dateModified" datetime="2022-03-06T17:38:01+00:00">2022-03-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Javascript/" itemprop="url" rel="index"><span itemprop="name">æ·±å…¥ç†è§£Javascript</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>12 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="ç¼–ç é—®é¢˜"><a href="#ç¼–ç é—®é¢˜" class="headerlink" title="ç¼–ç é—®é¢˜"></a>ç¼–ç é—®é¢˜</h1><p>ä¸ºäº†ææ¸…æ¥š Javascript ä¸­å­—ç¬¦ä¸²ä¸ç¼–ç ç›¸å…³çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£å­—ç¬¦ç¼–ç çš„åŸºæœ¬æ¦‚å¿µã€‚<a href="/2022/03/06/misc/encoding/">æ–‡ç« </a>ä»‹ç»äº†å­—ç¬¦é›†ï¼ˆCharacter Setï¼‰ã€å­—ç¬¦ç¼–ç ï¼ˆCharacter Encodingï¼‰ã€ç ç‚¹ï¼ˆCode Point)ã€ç¼–ç å•å…ƒï¼ˆCode Unitï¼‰ç­‰æ¦‚å¿µï¼Œä»¥åŠ UCS2 å’Œ UTF16 ä¸¤ç§ç¼–ç æ–¹æ¡ˆçš„å†…å®¹ä¸åŒºåˆ«ã€‚</p>
<p>Javascript ç¼–ç é—®é¢˜éƒ½è¦è€ƒè™‘ä»¥ä¸‹è¿™äº›æƒ…å†µçš„å¤„ç†ã€‚</p>
<ol>
<li>ä¸­æ–‡ã€æ—¥æ–‡ã€è‹±æ–‡ç­‰å¤šè¯­è¨€æ”¯æŒé—®é¢˜</li>
<li>å­—ç¬¦çš„è§„èŒƒåŒ–é—®é¢˜ï¼ŒåŒä¸€ä¸ªå­—ç¬¦å¯ä»¥å•ä¸ªç ç‚¹è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å•ä¸ªç ç‚¹åŠ ç»„åˆå½¢å¼ã€‚</li>
<li>æœ‰äº›å­—ç¬¦åªæœ‰ç ç‚¹ç»„åˆå½¢å¼ï¼Œæ²¡æœ‰å¯¹åº”çš„æ­£è§„åŒ–å¤åˆå½¢å¼ï¼ˆNormalization Form Compositionï¼‰ã€‚</li>
<li>æœ‰äº›å­—ç¬¦å¯ä»¥ä½¿ç”¨å¤šä¸ªç»„åˆç¬¦å·ï¼ˆCombining Markï¼‰</li>
<li>å­—ç¬¦è¾¹ç•Œé—®é¢˜ï¼ˆGrapheme Cluster Boundariesï¼‰</li>
</ol>
<h1 id="æºç çš„ç¼–ç å½¢å¼"><a href="#æºç çš„ç¼–ç å½¢å¼" class="headerlink" title="æºç çš„ç¼–ç å½¢å¼"></a>æºç çš„ç¼–ç å½¢å¼</h1><p><a target="_blank" rel="noopener" href="https://262.ecma-international.org/6.0/#sec-source-text">ECMAScript è§„èŒƒ</a>è§„å®šæºç å¯ä»¥ä½¿ç”¨ä»»ä½•åˆæ³•çš„ç ç‚¹ï¼ˆCode Pointï¼‰åºåˆ—ï¼Œä»¥ç ç‚¹åºåˆ—ä½œä¸ºè¾“å…¥è¿›è¡Œå¤„ç†ï¼Œå¯¹äºå®é™…å­˜å‚¨ä½¿ç”¨çš„ç¼–ç æ–¹æ¡ˆæ— è¦æ±‚ï¼Œåªè¦èƒ½è½¬æ¢å¾—åˆ°å¯¹åº”ç ç‚¹åºåˆ—å³å¯ã€‚</p>
<p>æºç çš„ Unicode ç ç‚¹åºåˆ—ä¸­å¦‚æœåŒ…æ‹¬ç»„åˆå­—ç¬¦åºåˆ—ï¼ˆcombining character sequenceï¼‰ï¼Œä¸ä¼šå¯¹å…¶è¿›è¡Œç»„åˆå½“æˆä¸€ä¸ªå­—ç¬¦è€Œæ˜¯å¯¹æ¯ä¸ªç ç‚¹å½“æˆä¸€ä¸ªå­—ç¬¦å¤„ç†ã€‚</p>
<p>Java å’Œ Javascript å¯¹äºæºç ä¸­å‡ºç°çš„ Unicode è½¬ä¹‰åºåˆ—å¤„ç†æ–¹å¼ä¸åŒï¼ŒJava ä¼šæŠŠè½¬ä¹‰åºåˆ—æ›¿æ¢ä¸ºå¯¹åº”å­—ç¬¦ï¼Œç„¶ååšè§£æå¤„ç†ã€‚å› æ­¤æ¢è¡Œç¬¦ï¼ˆLINE FEEDï¼‰è½¬ä¹‰åºåˆ—\u000A ä¼šä¸­æ–­æ³¨é‡Šè¡Œå’Œå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸‹é¢çš„ä»£ç ç›¸å½“äºä¸¤è¡Œå•è¡Œæ³¨é‡Š</span></span><br><span class="line"><span class="comment">// comment line \u000A // new line</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—ç¬¦ä¸²è¢«æ¢è¡Œç¬¦æ–­å¼€ï¼Œè¿™ç§å†™æ³•è¯­æ³•é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨\nçš„å½¢å¼åœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºæ¢è¡Œç¬¦</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;before \u000A new line&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>Javascript ä¸å¯¹ Unicode è½¬ä¹‰åºåˆ—è¿›è¡Œé¢„å¤„ç†ï¼Œè½¬ä¹‰åºåˆ—æ˜¯è¯­æ³•ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼ã€æ¨¡æ¿å­—ç¬¦ä¸²ã€æ ‡è¯†ç¬¦ç­‰è¯­æ³•ç»“æ„ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Unicode è½¬ä¹‰åºåˆ—ï¼ˆUnicode escape sequenceï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// ä¸€è¡Œå•è¡Œæ³¨é‡Š</span><br><span class="line">// comment line \u000A // new line</span><br><span class="line">// åˆæ³•å­—ç¬¦ä¸²</span><br><span class="line">const str = &#x27;before \u000A new line&#x27;</span><br><span class="line"></span><br><span class="line">// å˜é‡åç§°æ˜¯ sta</span><br><span class="line">const st\u0061 = &#x27;identifier name sta&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h1><h2 id="å†…éƒ¨æ ¼å¼"><a href="#å†…éƒ¨æ ¼å¼" class="headerlink" title="å†…éƒ¨æ ¼å¼"></a>å†…éƒ¨æ ¼å¼</h2><p>è§„èŒƒ <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-ecmascript-language-types-string-type">The String Type</a>è§„å®šäº† Javascript ä¸­çš„å­—ç¬¦ä¸²çš„å†…éƒ¨å­˜å‚¨æ ¼å¼æ˜¯é¡ºåºçš„ 16 ä½ç¼–ç å•å…ƒåºåˆ—ï¼Œæœ€å¤šå¯ä»¥åŒ…å« 2^53 - 1 ä¸ªç¼–ç å•å…ƒã€‚</p>
<blockquote>
<p>The String type is the set of all ordered sequences of zero or more 16-bit unsigned integer values (â€œelementsâ€) up to a maximum length of 2^53 - 1 elements.</p>
</blockquote>
<p>ç¼–ç å•å…ƒåºåˆ—å¯ä»¥è¡¨ç¤ºæ•´ä¸ª Unicode çš„ç¼–ç èŒƒå›´ï¼ˆ0x0000 ~ 0x10FFFFï¼‰ï¼Œä½†æ˜¯å¯¹ä»£ç†å¯¹çš„å¤„ç†è·Ÿ UCS2 å’Œ UCS16 æœ‰åŒºåˆ«ã€‚</p>
<p>UCS2 æ˜¯ 16 ä½å®šé•¿ç¼–ç ï¼Œåªèƒ½è¡¨ç¤ºåŸºæœ¬å¹³é¢ï¼ˆ0x0000 ~ 0xFFFFï¼‰å†…çš„å­—ç¬¦ï¼Œä¸èƒ½è¡¨ç¤ºè¡¥å……å¹³é¢çš„å­—ç¬¦ã€‚UTF16 æ˜¯å˜é•¿ç¼–ç ï¼Œä½¿ç”¨ä¸€ä¸ªç¼–ç å•å…ƒè¡¨ç¤ºåŸºæœ¬å¹³é¢å†…çš„å­—ç¬¦ï¼Œä½¿ç”¨ä¸¤ä¸ªç¼–ç å•å…ƒçš„ä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰è¡¨ç¤ºè¡¥å……å¹³é¢å­—ç¬¦ï¼Œä½†æ˜¯ä¸å…è®¸éæ³•çš„ä»£ç†å¯¹ã€‚</p>
<p>Javascript ä¸­çš„ç¼–ç ç›¸æ¯”äº UCS2 å¤šäº†<strong>ä»£ç†å¯¹</strong>çš„æ”¯æŒï¼Œç›¸æ¯”äº UTF16 åˆå…è®¸<strong>éæ³•çš„ä»£ç†å¯¹</strong>ï¼Œç ç‚¹ç¼–ç åˆ†ä¸ºä¸‰ç§æƒ…å†µã€‚</p>
<ol>
<li>ä¸å±äºä»£ç†å¯¹çš„å•ä¸ªç¼–ç å•å…ƒä»£è¡¨å…·æœ‰ç›¸åŒæ•°å€¼çš„ç ç‚¹ï¼Œå•ä¸ªç¼–ç å•å…ƒ<code>\u0061</code>ä»£è¡¨äº†è‹±æ–‡å­—æ¯<code>&quot;a&quot;</code>ã€‚</li>
<li>åˆæ³•çš„ä¸¤ä¸ªè¿ç»­çš„ç¼–ç å•å…ƒï¼Œç¬¬ä¸€ä¸ªæ˜¯é«˜ä»£ç†å¯¹ï¼Œç¬¬äºŒä¸ªæ˜¯ä½ä»£ç†å¯¹ï¼Œè¿™ä¸¤ä¸ªåˆèµ·æ¥è¢«è®¤ä¸ºæ˜¯ç›¸åº”çš„ç ç‚¹ã€‚<code>&#39;\uD83D\uDE00&#39;</code>ä»£è¡¨äº†å­—ç¬¦<code>&#39;ğŸ˜€&#39;</code>ï¼ˆU+1F600 GRINNING FACEï¼‰ã€‚</li>
<li>ä¸åœ¨åˆæ³•ä»£ç†å¯¹å½¢å¼ä¸­çš„å•ä¸ªä»£ç†å¯¹ä»£è¡¨å…·æœ‰ç›¸åŒæ•°å€¼çš„ç ç‚¹ï¼Œç¼–ç å•å…ƒ<code>&#39;\uD800&#39;</code>å°±ä»£è¡¨ç ç‚¹<code>\u&#123;D800&#125;</code>ï¼Œåªä¸è¿‡è¿™ä¸ªç ç‚¹åœ¨ Unicode ä¸­æ²¡æœ‰å¯¹åº”çš„æ–‡å­—ã€‚</li>
</ol>
<h2 id="å­—ç¬¦ä¸²å­—é¢é‡"><a href="#å­—ç¬¦ä¸²å­—é¢é‡" class="headerlink" title="å­—ç¬¦ä¸²å­—é¢é‡"></a>å­—ç¬¦ä¸²å­—é¢é‡</h2><p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html#sec-literals-string-literals">String Literal</a>è§„å®šäº† Javascript å­—ç¬¦ä¸²å­—é¢é‡ä¹¦å†™çš„è¯­æ³•å½¢å¼ã€‚Javascript ä¸­çš„å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·å¯¹ï¼ŒåŒºåˆ«åœ¨äºä½¿ç”¨å•å¼•å·æ—¶ï¼Œå­—ç¬¦ä¸²å†…éƒ¨çš„å•å¼•å·éœ€è¦ç”¨è½¬ä¹‰å½¢å¼<code>\&#39;</code>ï¼ŒåŒå¼•å·åŒç†éœ€è¦ä½¿ç”¨<code>\&quot;</code>ã€‚</p>
<p>Unicode ä¸­åŸºæœ¬å¹³é¢å†…çš„å­—ç¬¦æˆ–è€…<code>&#39;ğŸ˜€&#39;</code>ç­‰è¡¥å……å¹³é¢ä¸­çš„å­—ç¬¦éƒ½å¯ä»¥ç›´æ¥ä¹¦å†™ï¼Œå› ä¸ºå­—ç¬¦ä¸²å†…å¯ä»¥ä½¿ç”¨ç¬¦åˆæºç å­—ç¬¦ï¼ˆ<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-source-code.html#prod-SourceCharacter">SourceCharacter</a>ï¼‰å½¢å¼çš„ä»»æ„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯é™¤äº†å•åŒå¼•å·ã€åæ–œæ ã€æ¢è¡Œç¬¦ä¹‹å¤–çš„æ‰€æœ‰ Unicode å­—ç¬¦ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> chinese = <span class="string">&#x27;ä¸­æ–‡&#x27;</span></span><br><span class="line"><span class="keyword">let</span> grinningFace = <span class="string">&#x27;ğŸ˜€&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å¦å¤–å¯ä»¥ä½¿ç”¨å¤šç§å½¢å¼çš„è½¬ä¹‰åºåˆ—ï¼ˆEscapeSequenceï¼‰æ¥è¡¨ç¤ºä»»æ„ Unicode å­—ç¬¦ï¼Œå…³äº Javascript ä¸­è½¬ä¹‰åºåˆ—çš„ç»†èŠ‚å¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-escapes">æ–‡ç« </a>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•å­—ç¬¦è½¬ä¹‰åºåˆ—</span></span><br><span class="line"><span class="keyword">let</span> singleCharacterEscapeSequence = <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(singleCharacterEscapeSequence) <span class="comment">// =&gt; &quot;&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 16è¿›åˆ¶è½¬ä¹‰åºåˆ—</span></span><br><span class="line"><span class="keyword">let</span> hexadecimalEscapeSequence = <span class="string">&#x27;\x61&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(hexadecimalEscapeSequence) <span class="comment">// =&gt; &quot;a&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// unicodeè½¬ä¹‰åºåˆ—</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;My face \uD83D\uDE00&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str) <span class="comment">// =&gt; &#x27;My face ğŸ˜€&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6æ–°å¢çš„unicodeç ç‚¹è½¬ä¹‰åºåˆ—</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;Funny cat \u&#123;1F639&#125;&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str) <span class="comment">// =&gt; &#x27;Funny cat ğŸ˜¹&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¡¥å……å¹³é¢ä¸­çš„å­—ç¬¦å¯ä»¥ä½¿ç”¨ Unicode è½¬ä¹‰åºåˆ—ä»£ç†å¯¹çš„å½¢å¼ä¹¦å†™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Unicode ç ç‚¹è½¬ä¹‰åºåˆ—å½¢å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> spNiceEmoticon = <span class="string">&#x27;\uD83D\uDE07&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(spNiceEmoticon) <span class="comment">// =&gt; &#x27;ğŸ˜‡&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> niceEmoticon = <span class="string">&#x27;\u&#123;1F607&#125;&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(niceEmoticon) <span class="comment">// =&gt; &#x27;ğŸ˜‡&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(niceEmoticon === spNiceEmoticon) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ç§å½¢å¼è¡¨ç¤ºçš„å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„ï¼Œå­—é¢é‡ä¼šä½¿ç”¨ <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html#sec-static-semantics-sv">MV&#x2F;SV</a> çš„è¯­æ„è½¬æ¢ä¸º<strong>ç›¸åŒçš„</strong>å†…éƒ¨ 16 ä½ç¼–ç å•å…ƒåºåˆ—<code>&#39;\uD83D\uDE07&#39;</code>ã€‚</p>
<blockquote>
<p>When generating these String values Unicode code points are UTF-16 encoded as defined in 11.1.1.</p>
</blockquote>
<h2 id="ç›¸ç­‰æ€§"><a href="#ç›¸ç­‰æ€§" class="headerlink" title="ç›¸ç­‰æ€§"></a>ç›¸ç­‰æ€§</h2><p>ç”±äº Javascript å†…éƒ¨ä½¿ç”¨ 16 ä½ç¼–ç å•å…ƒåºåˆ—è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰çš„å«ä¹‰æ˜¯ä»£è¡¨å­—ç¬¦ä¸²çš„ä¸¤ä¸ªç¼–ç <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/abstract-operations.html#sec-samevaluenonnumeric">å•å…ƒåºåˆ—å®Œå…¨ä¸€è‡´</a>ï¼Œé•¿åº¦ç›¸åŒè€Œä¸”åœ¨ç›¸åŒä¸‹æ ‡çš„ç¼–ç å•å…ƒæ•°å€¼ç›¸åŒã€‚</p>
<p>å¯¹äºæ™®é€šå­—ç¬¦ä¸²æ¥è¯´è¿™ä¸ªå«ä¹‰ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸ<code>&#39;a&#39; === &#39;\u0061&#39;</code>ã€‚</p>
<p>ä½†æ˜¯å¯¹äºç»„åˆå­—ç¬¦æ¥è¯´ï¼ŒåŒä¸€ä¸ªå­—ç¬¦å¯ä»¥è¡¨ä¸ºä¸åŒçš„ç ç‚¹åºåˆ—ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­<code>str1</code>ä½¿ç”¨äº†è§„èŒƒåŒ–çš„ç»„åˆå½¢å¼ï¼ˆNormalization Form Compositionï¼‰è¡¨ç¤º<a target="_blank" rel="noopener" href="https://codepoints.net/U+00E7">å•ä¸ªå­—ç¬¦</a><code>&#39;Ã§&#39;</code>ï¼Œè¢«ä¿å­˜ä¸º<code>&#39;\u00E7&#39;</code>ï¼›<code>str2</code>ä½¿ç”¨äº†ç»„åˆçš„å½¢å¼<code>&#39;c\u0327&#39;</code>ï¼Œè¢«ä¿å­˜ä¸º<code>\u0063\u0327</code>ã€‚å­—ç¬¦ç›¸åŒï¼Œä½†æ˜¯ä½¿ç”¨çš„ç¼–ç å•å…ƒåºåˆ—ä¸åŒï¼Œå› æ­¤è¿™ä¸¤ä¸ªå­—ç¬¦ä¸ç›¸ç­‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">&#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">&#x27;c\u0327a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1 === str2) <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure>

<h2 id="å­—ç¬¦ä¸²é•¿åº¦"><a href="#å­—ç¬¦ä¸²é•¿åº¦" class="headerlink" title="å­—ç¬¦ä¸²é•¿åº¦"></a>å­—ç¬¦ä¸²é•¿åº¦</h2><p>å­—ç¬¦ä¸²çš„é•¿åº¦ï¼ˆ<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-properties-of-string-instances-length">length</a>ï¼‰æ˜¯ 16 ä½ç¼–ç å•å…ƒçš„ä¸ªæ•°ï¼Œä½†æ˜¯æœ‰äº›é¢å¤–æƒ…å†µå¯¼è‡´é•¿åº¦è¿”å›å€¼å’Œç›´è§‚é¢„æœŸå¯èƒ½å¹¶ä¸ä¸€è‡´ï¼Œå‚è€ƒæ–‡ç« <a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-unicode#counting-symbols">1</a>, <a target="_blank" rel="noopener" href="https://dmitripavlutin.com/what-every-javascript-developer-should-know-about-unicode/#33-string-length">2</a>ã€‚</p>
<h3 id="åŸºæœ¬æƒ…å†µ"><a href="#åŸºæœ¬æƒ…å†µ" class="headerlink" title="åŸºæœ¬æƒ…å†µ"></a>åŸºæœ¬æƒ…å†µ</h3><p>å¯¹äºåŸºæœ¬å¹³é¢ä¸­çš„å­—ç¬¦ï¼Œç¼–ç å•å…ƒçš„ä¸ªæ•°å°±æ˜¯å­—ç¬¦çš„ä¸ªæ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="property">length</span> <span class="comment">// =&gt; 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// U+554A</span></span><br><span class="line"><span class="string">&#x27;å•Š&#x27;</span>.<span class="property">length</span> <span class="comment">// =&gt; 1</span></span><br></pre></td></tr></table></figure>

<h3 id="è¡¥å……å¹³é¢å­—ç¬¦"><a href="#è¡¥å……å¹³é¢å­—ç¬¦" class="headerlink" title="è¡¥å……å¹³é¢å­—ç¬¦"></a>è¡¥å……å¹³é¢å­—ç¬¦</h3><p>å¯¹äºè¡¥å……å¹³é¢ä¸­çš„å­—ç¬¦æ¥è¯´ï¼Œä¸€ä¸ªå­—ç¬¦éœ€è¦ä¸¤ä¸ªç¼–ç å•å…ƒè¡¨ç¤ºï¼Œä¸ºäº†è·å¾—é¢„æœŸçš„å­—ç¬¦ä¸ªæ•°ï¼Œéœ€è¦å°†è¡¨ç¤ºä¸€ä¸ªä»£ç†å¯¹çš„ä¸¤ä¸ªç¼–ç å•å…ƒå½“æˆä¸€ä¸ªå­—ç¬¦å¤„ç†ã€‚å¯ä»¥ä½¿ç”¨<a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-unicode#iterating-over-symbols">stringâ€™s iterator</a>æ¥è·å¾—å­—ç¬¦ä¸²çš„ç ç‚¹åºåˆ—ï¼Œç„¶åè¿”å›ç ç‚¹åºåˆ—çš„ç ç‚¹ä¸ªæ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbols</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(string).<span class="property">length</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbols</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [...string].<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è·å¾—ç ç‚¹åºåˆ—é•¿åº¦éå†äº†å­—ç¬¦ä¸²çš„æ‰€æœ‰ç ç‚¹ä¼šé€ æˆæµªè´¹ï¼Œåªéœ€è¦å­—ç¬¦ä¸²é•¿åº¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/mathiasbynens/punycode.js">punycode</a> åº“ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbols</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> punycode.<span class="property">ucs2</span>.<span class="title function_">decode</span>(string).<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbols</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> punycode.<span class="property">ucs2</span>.<span class="title function_">decode</span>(string).<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªè¡Œå®ç°ä»£ç†å¯¹å¤„ç†çš„é€»è¾‘æ¥è·å¾—æ­£ç¡®çš„ç ç‚¹ä¸ªæ•°ã€‚</p>
<h3 id="ç»„åˆå­—ç¬¦"><a href="#ç»„åˆå­—ç¬¦" class="headerlink" title="ç»„åˆå­—ç¬¦"></a>ç»„åˆå­—ç¬¦</h3><p>å¯¹äºç»„åˆå­—ç¬¦ä¸åŒç¼–ç å½¢å¼ä½¿ç”¨çš„ç¼–ç å•å…ƒä¸ªæ•°ä¸åŒï¼Œå› æ­¤å­—ç¬¦ä¸²é•¿åº¦ä¹Ÿä¸ç›¸åŒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">&#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1.<span class="property">length</span>) <span class="comment">// =&gt; 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">&#x27;c\u0327a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2.<span class="property">length</span>) <span class="comment">// =&gt; 11</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³ç ç‚¹ï¼ˆCode Pointï¼‰çš„ä¸ªæ•°ï¼Œå¯ä»¥å°†å­—ç¬¦ä¸²è¿›è¡Œè§„èŒƒåŒ–ï¼ˆNormalization Form Compositionï¼‰ï¼Œä½¿ç”¨ç»Ÿä¸€çš„ç¼–ç å½¢å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">&#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1.<span class="title function_">normalize</span>().<span class="property">length</span>) <span class="comment">// =&gt; 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">&#x27;c\u0327a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2) <span class="comment">// =&gt; &#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2.<span class="title function_">normalize</span>().<span class="property">length</span>) <span class="comment">// =&gt; 10</span></span><br></pre></td></tr></table></figure>

<p>ä½†ä¸æ˜¯æ‰€æœ‰çš„ç»„åˆå­—ç¬¦åºåˆ—ä»£è¡¨çš„å•ä¸ªå­—ç¬¦éƒ½æœ‰å¯¹åº”çš„ç»å…¸å½¢å¼ï¼ˆCanonical Formï¼‰ï¼Œä¾‹å¦‚å­—ç¬¦<code>&#39;È©Ì&#39;</code>åŒ…å«äº†ä¸€ä¸ªåŸºç¡€å­—ç¬¦<code>&#39;e&#39;</code>å’Œä¸¤ä¸ªç»„åˆå­—ç¬¦ï¼ˆCombining Markï¼‰<code>\u0327\u0301</code>ï¼Œæ­£è§„åŒ–çš„ç»“æœåªèƒ½è¡¨ç¤ºä¸º<code>&#39;È©\u0301&#39;</code>ï¼Œæ‰€ä»¥æ­£è§„åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 5ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŒ…å«4ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="keyword">const</span> drink = <span class="string">&#x27;cafe\u0327\u0301&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(drink) <span class="comment">// =&gt; &#x27;cafÈ©Ì&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(drink.<span class="property">length</span>) <span class="comment">// =&gt; 6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(drink.<span class="title function_">normalize</span>()) <span class="comment">// =&gt; &#x27;cafÈ©Ì&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(drink.<span class="title function_">normalize</span>().<span class="property">length</span>) <span class="comment">// =&gt; 5</span></span><br></pre></td></tr></table></figure>

<p>è€ƒè™‘è¡¥å……å¹³é¢å­—ç¬¦å’Œç»„åˆå­—ç¬¦åŒæ—¶å­˜åœ¨çš„æƒ…å†µï¼Œå¯ä»¥å…ˆè¿›è¡Œè§„èŒƒåŒ–ï¼Œç„¶åè·å–ç ç‚¹ä¸ªæ•°ä½œä¸ºå­—ç¬¦ä¸²é•¿åº¦ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbolsPedantically</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="comment">// Unicode Normalization, NFC form, to account for lookalikes:</span></span><br><span class="line">  <span class="keyword">var</span> normalized = string.<span class="title function_">normalize</span>(<span class="string">&#x27;NFC&#x27;</span>)</span><br><span class="line">  <span class="comment">// Account for astral symbols / surrogates, just like we did before:</span></span><br><span class="line">  <span class="keyword">return</span> punycode.<span class="property">ucs2</span>.<span class="title function_">decode</span>(normalized).<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´å¤¸å¼ çš„æƒ…å†µæ˜¯æ³°æ–‡ä¸­å¯ä»¥ä½¿ç”¨ä»»æ„ä¸ªæ•°çš„ç»„åˆå­—ç¬¦ï¼Œå‡ºç°æ¯”è¾ƒå¥‡è‘©çš„æ•ˆæœã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çœ‹ç€æ˜¯6ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ¯ä¸ªå­—ç¬¦éƒ½åŒ…å«å¾ˆå¤šä¸ªç»„åˆå­—ç¬¦ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="title function_">countSymbolsPedantically</span>(<span class="string">&#x27;ZÍ‘Í«ÍƒÍªÌ‚Í«Ì½ÍÌ´Ì™Ì¤ÌÍ‰ÍšÌ¯ÌÌ ÍAÍ«Í—Ì´Í¢ÌµÌœÌ°Í”LÍ¨Í§Í©Í˜Ì GÌ‘Í—ÌÌ…Í›ÍÌ´Ì»ÍˆÍÍ”Ì¹OÍ‚ÌŒÌŒÍ˜Ì¨ÌµÌ¹Ì»ÌÌ³!Ì¿Ì‹Í¥Í¥Ì‚Í£ÌÌÌÍÍœÍ–Ì¬Ì°Ì™Ì—&#x27;</span>)</span><br><span class="line"><span class="number">74</span> <span class="comment">// not 6</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†ç»„åˆå­—ç¬¦å»æ‰ï¼Œåªä¿ç•™åŸºç¡€å­—ç¬¦æ¥è·å–æ­£ç¡®çš„å­—ç¬¦ä¸ªæ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Note: replace the following regular expression with its transpiled equivalent</span></span><br><span class="line"><span class="comment">// to make it work in old environments. https://mths.be/bwm</span></span><br><span class="line"><span class="keyword">var</span> regexSymbolWithCombiningMarks = <span class="regexp">/(\P&#123;Mark&#125;)(\p&#123;Mark&#125;+)/gu</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">countSymbolsIgnoringCombiningMarks</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="comment">// Remove any combining marks, leaving only the symbols they belong to:</span></span><br><span class="line">  <span class="keyword">var</span> stripped = string.<span class="title function_">replace</span>(</span><br><span class="line">    regexSymbolWithCombiningMarks,</span><br><span class="line">    <span class="keyword">function</span> (<span class="params">$<span class="number">0</span>, symbol, combiningMarks</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> symbol</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  <span class="comment">// Account for astral symbols / surrogates, just like we did before:</span></span><br><span class="line">  <span class="keyword">return</span> punycode.<span class="property">ucs2</span>.<span class="title function_">decode</span>(stripped).<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å­—ç¬¦è¾¹ç•Œ"><a href="#å­—ç¬¦è¾¹ç•Œ" class="headerlink" title="å­—ç¬¦è¾¹ç•Œ"></a>å­—ç¬¦è¾¹ç•Œ</h3><p>Unicode ä¸­é™¤äº†ä¸Šé¢çš„ç»„åˆå­—ç¬¦çš„æƒ…å†µï¼Œè¿˜æœ‰å¤šä¸ªç‹¬ç«‹å­—ç¬¦å¯ä»¥å…±åŒåˆæˆä¸€ä¸ªå­—ç¬¦çš„æƒ…å†µã€‚</p>
<p>éŸ©æ–‡ à®¨à®¿ (à®¨ + à®¿)å’Œ á„á…¡á†¨ (á„ + á…¡ + á†¨)ã€‚</p>
<p>é¢œæ–‡å­— ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ (ğŸ‘¨ + U+200D ZERO WIDTH JOINER + ğŸ‘© + U+200D ZERO WIDTH JOINER + ğŸ‘§ + U+200D ZERO WIDTH JOINER + ğŸ‘¦)ã€‚</p>
<p>å¯ä»¥å‚è€ƒ UAX ä¸­å…³äº<a target="_blank" rel="noopener" href="http://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">å­—ç¬¦è¾¹ç•Œçš„ç®—æ³•</a>ï¼Œè§„å®šäº†ç ç‚¹åºåˆ—ä¸­åˆ°åº•å“ªäº›å­—ç¬¦åˆèµ·æ¥æ„æˆä¸€ä¸ªå­—å½¢ï¼ˆGraphemeï¼‰ï¼Œè¿™ä¸ªæ¦‚å¿µæ‰çœŸæ­£å¯¹åº”å¸¸è§„æ„ä¹‰ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚</p>
<h2 id="String-prototype-å¯¹è±¡æ–¹æ³•"><a href="#String-prototype-å¯¹è±¡æ–¹æ³•" class="headerlink" title="String.prototype å¯¹è±¡æ–¹æ³•"></a>String.prototype å¯¹è±¡æ–¹æ³•</h2><h3 id="charAt-amp-charCodeAt-amp-fromCharCode"><a href="#charAt-amp-charCodeAt-amp-fromCharCode" class="headerlink" title="charAt &amp; charCodeAt &amp; fromCharCode"></a>charAt &amp; charCodeAt &amp; fromCharCode</h3><p><code>chartCodeAt</code>æ–¹æ³•è·å–å­—ç¬¦ä¸²æŒ‡å®šä¸‹æ ‡çš„ç¼–ç å•å…ƒï¼Œè¿”å›ç»“æœæ˜¯æ•°å­—ï¼›<code>charAt</code>æ–¹æ³•è·å–å­—ç¬¦ä¸²åœ¨æŒ‡å®šä¸‹æ ‡çš„ç¼–ç å•å…ƒå¯¹åº”çš„å­—ç¬¦ï¼Œè¿”å›ç»“æœæ˜¯å­—ç¬¦ä¸²ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•æŸ¥è¯¢çš„ä¸‹æ ‡å¯¹åº”åŸºæœ¬å¹³é¢å†…å­—ç¬¦æ—¶ç»“æœæ­£ç¡®ï¼Œå¯¹åº”ä»£ç†å¯¹æ—¶ç»“æœå°†ä»£ç†å¯¹æ‹†åˆ†ï¼Œå•ä¸ªå¤„ç†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">charCodeAt</span>(<span class="number">0</span>) <span class="comment">// \uD83D</span></span><br><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">charAt</span>(<span class="number">0</span>) <span class="comment">// \uD83D æ²¡æœ‰å¯¹åº”å­—ç¬¦æ¸²æŸ“ä¸º &#x27;ï¿½&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">charCodeAt</span>(<span class="number">1</span>) <span class="comment">// \uDCA9</span></span><br><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">charAt</span>(<span class="number">1</span>) <span class="comment">// \uDCA9 \uD83D æ²¡æœ‰å¯¹åº”å­—ç¬¦æ¸²æŸ“ä¸º &#x27;ï¿½&#x27;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string.fromcharcode"><code>fromCharCode</code></a>ä»ç»™å®šç¼–ç å•å…ƒæ•°å€¼åˆ›å»ºå¯¹åº”å­—ç¬¦ï¼Œè¶…è¿‡ 0xFFFF çš„æ•°å€¼ä¼šè¢«æˆªæ–­ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">0x0041</span>) <span class="comment">// U+0041</span></span><br><span class="line"><span class="string">&#x27;A&#x27;</span> <span class="comment">// U+0041</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">0x1F4A9</span>) <span class="comment">// U+1F4A9</span></span><br><span class="line"><span class="string">&#x27;ï’©&#x27;</span> <span class="comment">// U+F4A9, not U+1F4A9</span></span><br></pre></td></tr></table></figure>

<h3 id="at-amp-codePointAt-amp-fromCodePoint"><a href="#at-amp-codePointAt-amp-fromCodePoint" class="headerlink" title="at &amp; codePointAt &amp; fromCodePoint"></a>at &amp; codePointAt &amp; fromCodePoint</h3><p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-source-code.html#sec-codepointat"><code>codePointAt</code></a>è·å–å­—ç¬¦ä¸²æŒ‡å®šä¸‹æ ‡ä½ç½®çš„ç ç‚¹ï¼Œå¦‚æœä¸‹æ ‡ä½ç½®å¼€å§‹æ˜¯ä¸ªåˆæ³•ä»£ç†å¯¹ï¼Œè¿”å›ä»£ç†å¯¹ä»£è¡¨çš„ç ç‚¹ï¼Œå¦åˆ™è¿”å›ä¸‹æ ‡æ‰€åœ¨å•ä¸ªç¼–ç å•å…ƒå€¼å¯¹åº”çš„ç ç‚¹ï¼Œè¿”å›ç»“æœæ˜¯æ•°å­—ç±»å‹ï¼›<code>at</code>å¤„ç†ç›¸åŒï¼Œè¿”å›ç»“æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ˆES7 è§„èŒƒå†…å®¹ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">at</span>(<span class="number">0</span>) <span class="comment">// U+1F4A9</span></span><br><span class="line"><span class="string">&#x27;ğŸ’©&#x27;</span>.<span class="title function_">codePointAt</span>(<span class="number">0</span>) <span class="comment">// U+1F4A9</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string.fromcodepoint"><code>String.fromCodePoint</code></a>ä»ç»™ç‚¹çš„ç ç‚¹åºåˆ—åˆ›å»ºå­—ç¬¦ä¸²ï¼Œå¦‚æœç ç‚¹åºåˆ—ä¸æ˜¯æ•´æ•°æˆ–è€…è¶…å‡ºäº† Unicode ç ç‚¹èŒƒå›´ 0x10FFFF ä¼šæŠ›å‡º<code>RangeError</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">String</span>.<span class="title function_">fromCodePoint</span>(<span class="number">0x1f4a9</span>) <span class="comment">// &#x27;ğŸ’©&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="normalize"><a href="#normalize" class="headerlink" title="normalize"></a>normalize</h3><p>ä½¿ç”¨<code>normalize</code><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string.prototype.normalize">æ–¹æ³•</a>å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ­£è§„åŒ–ï¼Œæœ‰å››ä¸ªé€‰é¡¹ã€‚</p>
<p>â€˜NFCâ€™ as Normalization Form Canonical Composition<br>â€˜NFDâ€™ as Normalization Form Canonical Decomposition<br>â€˜NFKCâ€™ as Normalization Form Compatibility Composition<br>â€˜NFKDâ€™ as Normalization Form Compatibility Decomposition</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">&#x27;Ã§a va bien&#x27;</span></span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">&#x27;c\u0327a va bien&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1.<span class="title function_">normalize</span>() === str2.<span class="title function_">normalize</span>()) <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1 === str2)</span><br></pre></td></tr></table></figure>

<p>è§„èŒƒåŒ–çš„è¿‡ç¨‹å‚è€ƒ<a target="_blank" rel="noopener" href="https://unicode.org/reports/tr15/">UnicodeÂ® Standard Annex #15 UNICODE NORMALIZATION FORMS</a></p>
<h3 id="éå†å­—ç¬¦ä¸²ç ç‚¹"><a href="#éå†å­—ç¬¦ä¸²ç ç‚¹" class="headerlink" title="éå†å­—ç¬¦ä¸²ç ç‚¹"></a>éå†å­—ç¬¦ä¸²ç ç‚¹</h3><p>å­—ç¬¦ä¸²å­˜å‚¨ä¸º 16 ä½ç¼–ç å•å…ƒï¼Œæ‰€ä»¥éå†å­—ç¬¦ä¸²ç¼–ç å•å…ƒéå¸¸ç®€å•ã€‚éå†å­—ç¬¦ä¸²å†…çš„<strong>ç ç‚¹åºåˆ—</strong>éœ€è¦å¤„ç†ä»£ç†å¯¹ï¼Œå¯ä»¥æ‰‹åŠ¨å®ç°è¿™ä¸ªé€»è¾‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getSymbols</span>(<span class="params">string</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> index = <span class="number">0</span></span><br><span class="line">  <span class="keyword">var</span> length = string.<span class="property">length</span></span><br><span class="line">  <span class="keyword">var</span> output = []</span><br><span class="line">  <span class="keyword">for</span> (; index &lt; length; ++index) &#123;</span><br><span class="line">    <span class="keyword">var</span> charCode = string.<span class="title function_">charCodeAt</span>(index)</span><br><span class="line">    <span class="keyword">if</span> (charCode &gt;= <span class="number">0xd800</span> &amp;&amp; charCode &lt;= <span class="number">0xdbff</span>) &#123;</span><br><span class="line">      charCode = string.<span class="title function_">charCodeAt</span>(index + <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">if</span> (charCode &gt;= <span class="number">0xdc00</span> &amp;&amp; charCode &lt;= <span class="number">0xdfff</span>) &#123;</span><br><span class="line">        output.<span class="title function_">push</span>(string.<span class="title function_">slice</span>(index, index + <span class="number">2</span>))</span><br><span class="line">        ++index</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    output.<span class="title function_">push</span>(string.<span class="title function_">charAt</span>(index))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> output</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> symbols = <span class="title function_">getSymbols</span>(<span class="string">&#x27;ğŸ’©&#x27;</span>)</span><br><span class="line">symbols.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">symbol</span>) &#123;</span><br><span class="line">  <span class="title function_">assert</span>(symbol == <span class="string">&#x27;ğŸ’©&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥åˆ©ç”¨ String ç±»å‹çš„<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string.prototype-@@iterator">è¿­ä»£å™¨åè®®</a>ï¼Œ<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string-iterator-objects">å­—ç¬¦ä¸²è¿­ä»£å™¨å¯¹è±¡</a>è¿”å›å­—ç¬¦ä¸²çš„ç ç‚¹åºåˆ—ï¼Œæ¯ä¸ªç ç‚¹ä»¥<strong>å­—ç¬¦ä¸²</strong>å½¢å¼è¿”å›ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> string = <span class="string">&#x27;\ud83d\udc0e\ud83d\udc71\u2764&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// for-ofå¾ªç¯åˆ©ç”¨äº†è¿­ä»£å™¨åè®®</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> codePoint <span class="keyword">of</span> string) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(codePoint.<span class="title function_">codePointAt</span>(<span class="number">0</span>).<span class="title function_">toString</span>(<span class="number">16</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#x27;1f40e&#x27;, &#x27;1f471&#x27;, &#x27;2764&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(string)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†…éƒ¨ä½¿ç”¨äº†è¿­ä»£å™¨åè®®</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">forEach</span>.<span class="title function_">call</span>(<span class="function">(<span class="params">codePoint</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(codePoint)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span>.<span class="title function_">call</span>(<span class="function">(<span class="params">codePoint</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(codePoint)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="å¤§å°å†™å¤„ç†"><a href="#å¤§å°å†™å¤„ç†" class="headerlink" title="å¤§å°å†™å¤„ç†"></a>å¤§å°å†™å¤„ç†</h3><p>locale ç›¸å…³æ“ä½œ localeCompare&#x2F;toLocaleLowerCase&#x2F;toLocaleUpperCase</p>
<p>å¤§å°å†™è½¬æ¢å¤„ç† toLowerCase &#x2F; toUpperCase</p>
<h3 id="String-prototype-çš„å…¶ä»–-API"><a href="#String-prototype-çš„å…¶ä»–-API" class="headerlink" title="String.prototype çš„å…¶ä»– API"></a>String.prototype çš„å…¶ä»– API</h3><p>å…¨å±€å­—ç¬¦ä¸²å¯¹è±¡åŸå‹<code>String.prototype</code>ä¸Šçš„<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-properties-of-the-string-prototype-object">å…¶ä»–æ“ä½œ</a>ä¹Ÿéƒ½æ˜¯å¯¹ 16 ä½ç¼–ç å•å…ƒåºåˆ—è¿›è¡Œå¤„ç†çš„ï¼Œä¹Ÿä¼šå› ä¸ºè¡¥å……å¹³é¢å­—ç¬¦ã€ç»„åˆå­—ç¬¦ã€å­—ç¬¦è¾¹ç•Œç­‰æƒ…å†µå‡ºç°ä¸é¢„æœŸä¸ä¸€è‡´çš„ç»“æœï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ã€‚</p>
<h2 id="å½¢å¼è½¬æ¢"><a href="#å½¢å¼è½¬æ¢" class="headerlink" title="å½¢å¼è½¬æ¢"></a>å½¢å¼è½¬æ¢</h2><p>å­—ç¬¦ä¸²çš„å¤„ç†éœ€è¦åœ¨ 16 ä½ç¼–ç å•å…ƒåºåˆ—å’Œç ç‚¹åºåˆ—ä¸¤ä¸ªå½¢å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œ<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-source-code.html#sec-source-text">è§„èŒƒ</a>ä¸­ä½¿ç”¨äº†ä»¥ä¸‹æŠ½è±¡æ“ä½œæè¿°æ­£åå‘çš„è½¬æ¢è¿‡ç¨‹ã€‚</p>
<p>ç ç‚¹åºåˆ—è½¬æ¢ä¸º 16 ä½ç¼–ç å•å…ƒåºåˆ—ï¼Œ<code>CodePointsToString(codePoints)</code>å°†çš„ç ç‚¹åºåˆ—<code>codePoints</code>è½¬æ¢ä¸º 16 ä½ç¼–ç å•å…ƒåºåˆ—ï¼Œå†…éƒ¨è°ƒç”¨<code>UTF16EncodeCodePoint(cp)</code>å°†å•ä¸ªç ç‚¹<code>cp</code>è½¬æ¢ä¸º 16 ä½ç¼–ç å•å…ƒä»£è¡¨çš„å­—ç¬¦ä¸²ã€‚</p>
<p>16 ä½ç¼–ç å•å…ƒåºåˆ—è½¬æ¢ä¸ºç ç‚¹åºåˆ—ï¼Œ<code>StringToCodePoints(string)</code>å°†<code>string</code>è½¬æ¢ä¸ºå¯¹åº”çš„ç ç‚¹åºåˆ—ï¼Œå†…éƒ¨è°ƒç”¨<code>CodePointAt(string, position)</code>è·å–ä½ç½®<code>position</code>å¯¹åº”çš„ç ç‚¹ï¼Œå†åµŒå¥—è°ƒç”¨ <code>UTF16SurrogatePairToCodePoint(lead, trail)</code>å°†å†…éƒ¨çš„ 16 ä½ç¼–ç å•å…ƒåºåˆ—ä¸­ä»£ç†å¯¹è½¬æ¢ä¸ºå¯¹åº”ç ç‚¹ï¼Œè¿”å›æ•°å­—ç±»å‹ã€‚</p>
<h2 id="åè½¬å­—ç¬¦ä¸²"><a href="#åè½¬å­—ç¬¦ä¸²" class="headerlink" title="åè½¬å­—ç¬¦ä¸²"></a>åè½¬å­—ç¬¦ä¸²</h2><p>åŸºæœ¬å¹³é¢ä¸­çš„éç»„åˆå­—ç¬¦åè½¬å­—ç¬¦ä¸²éå¸¸ç®€å•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reverseString</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¡¥å……å¹³é¢ä¸­çš„å­—ç¬¦éœ€è¦å…ˆè·å¾—ç ç‚¹åºåˆ—å†è¿›è¡Œåè½¬æ“ä½œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reverseString</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [...str].<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¯¹äºç»„åˆå­—ç¬¦çš„æƒ…å†µï¼Œä½ç½®åè½¬ä¼šé€ æˆç»„åˆå­—ç¬¦å¯¹åº”çš„åŸºç¡€å­—ç¬¦ä¸åŒï¼Œæ‰€ä»¥åè½¬ç»“æœä¸é¢„æœŸä¸ä¸€è‡´ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åè½¬å‰ä¿®é¥°å­—ç¬¦nï¼Œåè½¬åä¿®é¥°å­—ç¬¦a</span></span><br><span class="line">;[...<span class="string">&#x27;manÌƒana&#x27;</span>].<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>) <span class="comment">// &quot;anaÌƒnam&quot;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-unicode#counting-symbols#reversing-strings">ç»¼åˆè€ƒè™‘ä»¥ä¸Šæƒ…å†µ</a>ï¼Œå¯ä»¥ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/mathiasbynens/esrever">esrever</a>åº“æ¥å¤„ç†ä»£ç†å¯¹ã€ç»„åˆå­—ç¬¦ä¸²ç­‰é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">esrever.<span class="title function_">reverse</span>(<span class="string">&#x27;maÃ±ana&#x27;</span>) <span class="comment">// &#x27;anaÃ±am&#x27;</span></span><br><span class="line"></span><br><span class="line">esrever.<span class="title function_">reverse</span>(<span class="string">&#x27;ğŸ’©&#x27;</span>) <span class="comment">// &#x27;ğŸ’©&#x27; U+1F4A9</span></span><br></pre></td></tr></table></figure>

<h2 id="String-raw"><a href="#String-raw" class="headerlink" title="String.raw"></a>String.raw</h2><p><a target="_blank" rel="noopener" href="https://mothereff.in/js-escapes#1%F0%9D%8C%86">String.raw</a>æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²æ ‡ç­¾å‡½æ•°ï¼Œç”¨æ¥ä¿ç•™æ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„è½¬ä¹‰åºåˆ—ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// \n è¡¨ç¤ºæ¢è¡Œç¬¦</span></span><br><span class="line">;<span class="string">`Hi\n<span class="subst">$&#123;<span class="number">2</span> + <span class="number">3</span>&#125;</span>!`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// \n è¡¨ç¤ºåæ–œæ \å’Œå­—ç¬¦nï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦</span></span><br><span class="line"><span class="title class_">String</span>.<span class="property">raw</span><span class="string">`Hi\n<span class="subst">$&#123;<span class="number">2</span> + <span class="number">3</span>&#125;</span>!`</span></span><br></pre></td></tr></table></figure>

<h2 id="å­ä¸²åŒ¹é…æ“ä½œ"><a href="#å­ä¸²åŒ¹é…æ“ä½œ" class="headerlink" title="å­ä¸²åŒ¹é…æ“ä½œ"></a>å­ä¸²åŒ¹é…æ“ä½œ</h2><p>æŠ½è±¡æ“ä½œ<a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-stringindexof">StringIndexOf</a>å®šä¹‰äº†å­ä¸²åŒ¹é…çš„è¿‡ç¨‹ã€‚</p>
<h2 id="é™æ€è¯­ä¹‰-MV-x2F-SV"><a href="#é™æ€è¯­ä¹‰-MV-x2F-SV" class="headerlink" title="é™æ€è¯­ä¹‰ MV &#x2F; SV"></a>é™æ€è¯­ä¹‰ MV &#x2F; SV</h2><p>å­—ç¬¦ä¸²çš„ <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html#sec-string-literals-static-semantics-mv">MV</a> è¯­ä¹‰ä»å­—ç¬¦ä¸²å­—é¢é‡è·å¾—å¯¹åº” 16 ä½ç¼–ç åºåˆ—ä»£è¡¨çš„æ•´æ•°å€¼ã€‚</p>
<p>å­—ç¬¦ä¸²çš„ <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html#sec-static-semantics-sv">SV</a> è¯­ä¹‰ä»å­—ç¬¦ä¸²å­—é¢é‡è·å¾—å¯¹åº”çš„ 16 ä½ç¼–ç åºåˆ—ã€‚</p>
<h1 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h1><p>æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿé»˜è®¤ä½¿ç”¨ 16 ä½ç¼–ç å•å…ƒå¤„ç†å­—ç¬¦åŒ¹é…ï¼Œå› æ­¤åœ¨å¤„ç†è¡¥å……å¹³é¢å­—ç¬¦æ—¶å¯èƒ½å‡ºç°ä¸é¢„æœŸä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>
<h2 id="å­—ç¬¦ä¸ªæ•°åŒ¹é…"><a href="#å­—ç¬¦ä¸ªæ•°åŒ¹é…" class="headerlink" title="å­—ç¬¦ä¸ªæ•°åŒ¹é…"></a>å­—ç¬¦ä¸ªæ•°åŒ¹é…</h2><p>ç‚¹å·ï¼ˆ.ï¼‰åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ¹é…å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å¯¹äºè¡¨ç¤ºæˆä»£ç†å¯¹çš„è¡¥å……å¹³é¢å­—ç¬¦æ— æ³•åŒ¹é…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> smile = <span class="string">&#x27;ğŸ˜€&#x27;</span></span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^.$/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regex.<span class="title function_">test</span>(smile)) <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†åŒ¹é… 16 ä½ç¼–ç å•å…ƒåºåˆ—ä»£è¡¨çš„æ‰€æœ‰åˆæ³• Unicode å­—ç¬¦ä¸²åºåˆ—ï¼Œå¯ä»¥ç¼–å†™ç‰¹å®šæ¨¡å¼è¿›è¡ŒåŒ¹é…ï¼Œå°† Unicode ç ç‚¹åˆ†ä¸ºå››ç±»ã€‚</p>
<ol>
<li>åŸºæœ¬å¹³é¢ä¸­ä¸å±äºä»£ç†å¯¹çš„å­—ç¬¦ <code>/[\0-\uD7FF\uE000-\uFFFF]</code></li>
<li>ä¸¤ä¸ª 16 ä½ç¼–ç å•å…ƒçš„ä»£ç†å¯¹ <code>/[\uD800-\uDBFF][\uDC00-\uDFFF]/</code></li>
<li>ä¸å±äºä»£ç†å¯¹çš„å•ä¸ªé«˜ä»£ç†ï¼ˆlead surrogateï¼‰ç¼–ç å•å…ƒ <code>/[\uD800-\uDBFF](?![\uDC00-\uDFFF])/</code></li>
<li>ä¸å±äºä»£ç†å¯¹çš„å•ä¸ªä½ä»£ç†ï¼ˆtrail surrogateï¼‰ç¼–ç å•å…ƒ <code>/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/</code></li>
</ol>
<p>å°†è¿™å››ç§æƒ…å†µç»„åˆèµ·æ¥å°±èƒ½åŒ¹é…æ‰€æœ‰ Unicode å­—ç¬¦ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;<span class="regexp">/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/</span>.<span class="title function_">test</span>(</span><br><span class="line">  <span class="string">&#x27;ğŸ’©&#x27;</span></span><br><span class="line">) <span class="comment">// wtf</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://mths.be/regenerate">regenerate</a>åº“å¯ä»¥æ–¹ä¾¿çš„ç”ŸæˆåŒ¹é…æŒ‡å®š Unicode ç ç‚¹èŒƒå›´çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">regenerate</span>().<span class="title function_">addRange</span>(<span class="number">0x0</span>, <span class="number">0x10ffff</span>).<span class="title function_">toString</span>()</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ ES6 æ–°å¢çš„æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿— u å¼€å¯ Unicode æ”¯æŒï¼Œä¹Ÿå¯ä»¥è§£å†³ç‚¹å·åŒ¹é…çš„é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> smile = <span class="string">&#x27;ğŸ˜€&#x27;</span></span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^.$/u</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regex.<span class="title function_">test</span>(smile)) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>

<h2 id="å­—ç¬¦èŒƒå›´åŒ¹é…"><a href="#å­—ç¬¦èŒƒå›´åŒ¹é…" class="headerlink" title="å­—ç¬¦èŒƒå›´åŒ¹é…"></a>å­—ç¬¦èŒƒå›´åŒ¹é…</h2><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼èŒƒå›´åŒ¹é…å½¢å¼ä¸­ç›´æ¥ä½¿ç”¨è¡¥å……å¹³é¢å­—ç¬¦ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;<span class="regexp">/[ğŸ’©-ğŸ’«]/</span></span><br><span class="line"><span class="comment">// =&gt; SyntaxError: Invalid regular expression: /[ğŸ’©-ğŸ’«]/:</span></span><br><span class="line"><span class="comment">// Range out of order in character class</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºä¸Šé¢çš„å½¢å¼ç›¸å½“äº</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;<span class="regexp">/[\uD83D\uDCA9-\uD83D\uDCAB]/</span></span><br></pre></td></tr></table></figure>

<p>ä¸­é—´çš„èŒƒå›´æ˜¯ä¸€ä¸ªå¼€å§‹å€¼æ¯”ç»“æŸå€¼å¤§çš„éæ³•èŒƒå›´ã€‚åŒæ ·å¯ä»¥ä½¿ç”¨ u æ ‡å¿—å¼€å¯å¯¹ Unicode å­—ç¬¦çš„æ”¯æŒã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="regexp">/[\uD83D\uDCA9-\uD83D\uDCAB]/u</span>.<span class="title function_">test</span>(<span class="string">&#x27;\uD83D\uDCA9&#x27;</span>) <span class="comment">// match U+1F4A9</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="regexp">/[\u&#123;1F4A9&#125;-\u&#123;1F4AB&#125;]/u</span>.<span class="title function_">test</span>(<span class="string">&#x27;\u&#123;1F4AA&#125;&#x27;</span>) <span class="comment">// match U+1F4AA</span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line"></span><br><span class="line">&gt;&gt; <span class="regexp">/[ğŸ’©-ğŸ’«]/u</span>.<span class="title function_">test</span>(<span class="string">&#x27;ğŸ’ª&#x27;</span>) <span class="comment">// match U+1F4AA</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœéœ€è¦åœ¨ ES5 ç­‰ç¯å¢ƒä¸­è¿›è¡Œå…¼å®¹å¤„ç†ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨ regenerate åº“ç”Ÿæˆç›¸åº” Unicode å­—ç¬¦åŒ¹é…å½¢å¼ã€‚</p>
<h2 id="ç»„åˆå­—ç¬¦-1"><a href="#ç»„åˆå­—ç¬¦-1" class="headerlink" title="ç»„åˆå­—ç¬¦"></a>ç»„åˆå­—ç¬¦</h2><p>æ­£åˆ™è¡¨è¾¾å¼çš„ Unicode æ”¯æŒæ ‡å¿— u æ— æ³•å¤„ç†ç»„åˆå­—ç¬¦ï¼ˆCombining Markï¼‰ï¼Œå› ä¸ºå³ä½¿å¼€å¯äº† Unicode æ”¯æŒï¼Œä¹Ÿæ˜¯ä»¥å•ä¸ªç ç‚¹ä½œä¸ºå­—ç¬¦è¿›è¡ŒåŒ¹é…ï¼Œç»„åˆå­—ç¬¦çš„å½¢å¼æ˜¯ç”±å¤šä¸ªç ç‚¹ç»„æˆçš„ï¼Œè¿™ç§æƒ…å†µä¸‹åªèƒ½é€šè¿‡å°†åŸºç¡€å­—ç¬¦ï¼ˆbase characterï¼‰å’Œç»„åˆå­—ç¬¦ï¼ˆCombining Markï¼‰åˆ†å¼€ä¹¦å†™ä¸ºæ¨¡å¼è¿›è¡ŒåŒ¹é…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> drink = <span class="string">&#x27;cafe\u0301&#x27;</span></span><br><span class="line"><span class="keyword">const</span> regex1 = <span class="regexp">/^.&#123;4&#125;$/</span></span><br><span class="line"><span class="keyword">const</span> regex2 = <span class="regexp">/^.&#123;5&#125;$/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(drink) <span class="comment">// =&gt; &#x27;cafÃ©&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regex1.<span class="title function_">test</span>(drink)) <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regex2.<span class="title function_">test</span>(drink)) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä¾‹å­ä¸­<code>drink</code>ä»£è¡¨çš„å­—ç¬¦åŒ…å«äº”ä¸ªç ç‚¹ã€‚</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p>å¯¹ Javascript ä¸­å­—ç¬¦ä¸²ä¸ç¼–ç é—®é¢˜å¯ä»¥é˜…è¯»ä»¥ä¸‹å†…å®¹ã€‚</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://dmitripavlutin.com/what-every-javascript-developer-should-know-about-unicode/">What every JavaScript developer should know about Unicode</a></li>
<li><a target="_blank" rel="noopener" href="https://cjting.me/2018/07/22/js-and-unicode/">JavaScript ä¸ Unicode</a></li>
<li>ã€ŠEffective Javascriptã€‹ Item 7 Think of Strings As Sequences of 16-bit Code Units</li>
<li>ã€ŠUnderstanding ECMAScript 6ã€‹Chapter 2 String and Regular Expressions<br>ECMAScript è§„èŒƒä¸­ä¸å­—ç¬¦ä¸²ç›¸å…³çš„å†…å®¹ã€‚</li>
</ol>
<p>æ›´æ·±å…¥ç»†è‡´çš„ä»‹ç»å¯ä»¥å‚è€ƒ Mathias Bynens çš„ç³»åˆ—åšå®¢ã€‚</p>
<p>å­—ç¬¦ä¸²ç¼–ç ç³»åˆ—</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-unicode">JavaScript has a Unicode problem</a></li>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-escapes">JavaScript character escape sequences</a></li>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/javascript-encoding">JavaScriptâ€™s internal character encoding: UCS-2 or UTF-16? </a></li>
</ol>
<p>æ­£åˆ™è¡¨è¾¾å¼ç³»åˆ—</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/es-regexp-proposals">ECMAScript regular expressions are getting better!</a></li>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/es-unicode-property-escapes">Unicode property escapes in JavaScript regular expressions</a></li>
<li><a target="_blank" rel="noopener" href="https://mathiasbynens.be/notes/es6-unicode-regex">Unicode-aware regular expressions in ES2015</a></li>
</ol>
<p>æœ€åå¯¹äºå…·ä½“çš„ç»†èŠ‚å¯ä»¥å‚è€ƒ ECMAScript è§„èŒƒä¸­æ¶‰åŠåˆ°å­—ç¬¦ä¸²ä¸ç¼–ç çš„ç›¸å…³å†…å®¹ã€‚</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://262.ecma-international.org/6.0/#sec-source-text">Source Text</a> <a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-source-code.html#sec-ecmascript-language-source-code">ES2022</a></li>
<li><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html#sec-ecmascript-language-lexical-grammar-literals">ECMAScript Language: Lexical Grammar String Literals</a></li>
<li><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/ecmascript-data-types-and-values.html#sec-ecmascript-language-types-string-type">ECMAScript Data Types and Values The String Type</a></li>
<li><a target="_blank" rel="noopener" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string-objects">Text Process String Objects</a></li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>penghui
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="http://marked42.github.io/2022/02/24/js/encoding/" title="Javascriptä¸­å­—ç¬¦ä¸²ä¸ç¼–ç é—®é¢˜">http://marked42.github.io/2022/02/24/js/encoding/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A0%81/" rel="tag"># ç¼–ç </a>
              <a href="/tags/Unicode/" rel="tag"># Unicode</a>
              <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="tag"># å­—ç¬¦ä¸²</a>
              <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag"># æ­£åˆ™è¡¨è¾¾å¼</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/24/js/identifier-name/" rel="prev" title="Javascriptä¸­ä»€ä¹ˆæ˜¯åˆæ³•å˜é‡åï¼Ÿ">
      <i class="fa fa-chevron-left"></i> Javascriptä¸­ä»€ä¹ˆæ˜¯åˆæ³•å˜é‡åï¼Ÿ
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/03/06/babel/advanced/ast/" rel="next" title="æŠ½è±¡è¯­æ³•æ ‘">
      æŠ½è±¡è¯­æ³•æ ‘ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">1.</span> <span class="nav-text">ç¼–ç é—®é¢˜</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E7%9A%84%E7%BC%96%E7%A0%81%E5%BD%A2%E5%BC%8F"><span class="nav-number">2.</span> <span class="nav-text">æºç çš„ç¼–ç å½¢å¼</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">3.</span> <span class="nav-text">å­—ç¬¦ä¸²</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E9%83%A8%E6%A0%BC%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">å†…éƒ¨æ ¼å¼</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="nav-number">3.2.</span> <span class="nav-text">å­—ç¬¦ä¸²å­—é¢é‡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E7%AD%89%E6%80%A7"><span class="nav-number">3.3.</span> <span class="nav-text">ç›¸ç­‰æ€§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6"><span class="nav-number">3.4.</span> <span class="nav-text">å­—ç¬¦ä¸²é•¿åº¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%83%85%E5%86%B5"><span class="nav-number">3.4.1.</span> <span class="nav-text">åŸºæœ¬æƒ…å†µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%E5%B9%B3%E9%9D%A2%E5%AD%97%E7%AC%A6"><span class="nav-number">3.4.2.</span> <span class="nav-text">è¡¥å……å¹³é¢å­—ç¬¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E5%AD%97%E7%AC%A6"><span class="nav-number">3.4.3.</span> <span class="nav-text">ç»„åˆå­—ç¬¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E8%BE%B9%E7%95%8C"><span class="nav-number">3.4.4.</span> <span class="nav-text">å­—ç¬¦è¾¹ç•Œ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#String-prototype-%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.</span> <span class="nav-text">String.prototype å¯¹è±¡æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#charAt-amp-charCodeAt-amp-fromCharCode"><span class="nav-number">3.5.1.</span> <span class="nav-text">charAt &amp; charCodeAt &amp; fromCharCode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#at-amp-codePointAt-amp-fromCodePoint"><span class="nav-number">3.5.2.</span> <span class="nav-text">at &amp; codePointAt &amp; fromCodePoint</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#normalize"><span class="nav-number">3.5.3.</span> <span class="nav-text">normalize</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%A0%81%E7%82%B9"><span class="nav-number">3.5.4.</span> <span class="nav-text">éå†å­—ç¬¦ä¸²ç ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E5%A4%84%E7%90%86"><span class="nav-number">3.5.5.</span> <span class="nav-text">å¤§å°å†™å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#String-prototype-%E7%9A%84%E5%85%B6%E4%BB%96-API"><span class="nav-number">3.5.6.</span> <span class="nav-text">String.prototype çš„å…¶ä»– API</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%A2%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-number">3.6.</span> <span class="nav-text">å½¢å¼è½¬æ¢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E8%BD%AC%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">3.7.</span> <span class="nav-text">åè½¬å­—ç¬¦ä¸²</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#String-raw"><span class="nav-number">3.8.</span> <span class="nav-text">String.raw</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E4%B8%B2%E5%8C%B9%E9%85%8D%E6%93%8D%E4%BD%9C"><span class="nav-number">3.9.</span> <span class="nav-text">å­ä¸²åŒ¹é…æ“ä½œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E8%AF%AD%E4%B9%89-MV-x2F-SV"><span class="nav-number">3.10.</span> <span class="nav-text">é™æ€è¯­ä¹‰ MV &#x2F; SV</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">4.</span> <span class="nav-text">æ­£åˆ™è¡¨è¾¾å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%AA%E6%95%B0%E5%8C%B9%E9%85%8D"><span class="nav-number">4.1.</span> <span class="nav-text">å­—ç¬¦ä¸ªæ•°åŒ¹é…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E8%8C%83%E5%9B%B4%E5%8C%B9%E9%85%8D"><span class="nav-number">4.2.</span> <span class="nav-text">å­—ç¬¦èŒƒå›´åŒ¹é…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E5%AD%97%E7%AC%A6-1"><span class="nav-number">4.3.</span> <span class="nav-text">ç»„åˆå­—ç¬¦</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">5.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="penghui"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">penghui</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/marked42" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;marked42" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:penghui.zhang@foxmail.com" title="E-Mail â†’ mailto:penghui.zhang@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">penghui</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">68k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:01</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

    </div>
</body>
</html>
